import React from 'react';
import { useSpring, animated } from 'react-spring';
import { useMove } from 'react-use-gesture';

import { loremIpsum } from 'lorem-ipsum';

import './style.scss';

const Bg = () => (
	<g id="bg">
		<path d="M490,267 C490,402.308594 380.308594,512 245,512 C109.691406,512 0,402.308594 0,267 C0,131.691406 109.691406,22 245,22 C380.308594,22 490,131.691406 490,267 Z" />
	</g>
);

const Sweater = () => (
	<g id="sweater">
		<path d="M282,0 L251.722656,0 C224.347656,23.640625 188.875,37.5 151,37.5 C113.128906,37.5 77.65625,23.640625 50.277344,0 L20,0 C9,0 2.84217094e-14,9 2.84217094e-14,20 L2.84217094e-14,98.945312 C41.609375,131.554688 94.035156,151 151,151 C207.964844,151 260.390625,131.554688 302,98.945312 L302,20 C302,9 293,0 282,0 Z" />
		<path d="M0,20 L0,98.945312 C9.464844,106.359375 19.492188,113.089844 30,119.066406 L30,20 C30,9 39,0 50,0 L20,0 C9,0 0,9 0,20 Z" />
		<path d="M151,151 C175.925781,151 199.984375,147.277344 222.648438,140.355469 C217.285156,105.605469 187.25,79 151,79 C114.75,79 84.714844,105.605469 79.355469,140.355469 C102.015625,147.277344 126.074219,151 151,151 Z" />
	</g>
);

const Face = () => (
	<animated.g id="face">
		<path d="M155,294 C69.746094,294 0.382812,224.640625 0.382812,139.382812 C0.382812,124.1875 2.59375,109.15625 6.949219,94.707031 C7.535156,92.765625 9.230469,91.371094 11.246094,91.175781 C25.488281,89.773438 54.296875,85.5 87.210938,72.605469 C127.386719,56.867188 162.125,33.175781 190.460938,2.191406 C191.414062,1.148438 192.753906,0.566406 194.148438,0.566406 C194.351562,0.566406 194.554688,0.578125 194.761719,0.601562 C196.367188,0.800781 197.777344,1.765625 198.546875,3.1875 C231.648438,64.441406 280.03125,84.359375 299.296875,90.082031 C300.894531,90.558594 302.152344,91.796875 302.648438,93.390625 C307.269531,108.242188 309.613281,123.714844 309.613281,139.382812 C309.613281,224.640625 240.257812,294 155,294 Z" />
		<path d="M24.769531,128.816406 C24.1468237,115.207898 26.566406,101.660156 30.085938,88.578125 C22.433594,89.910156 16.019531,90.707031 11.246094,91.175781 C9.230469,91.371094 7.535156,92.769531 6.949219,94.707031 C2.59375,109.15625 0.382812,124.1875 0.382812,139.382812 C0.382812,215.429688 55.570312,278.828125 128,291.636719 C62.7239587,260.545573 28.3138023,206.272135 24.769531,128.816406 Z" />
	</animated.g>
);

const svgTrans: any = (x: number, y: number): string => {
	return `perspective(400px) rotateY(${x / 60}deg) rotateX(${-y / 60}deg) translate3d(-50%,-50%,0)`;
};

const ScrollParallax: React.FC = () => {
	const text = React.useRef<string>(loremIpsum({ count: 200 }));

	const [{ sy, xy }, set] = useSpring(() => ({ sy: 0, xy: [0, 0] }));

	const bind = useMove(state => {
		console.log(state.xy);
		const [x, y] = state.xy;
		set({ xy: [x - window.innerWidth / 2, y - window.innerHeight / 2] });
	});

	return (
		<div className="container" {...bind()}>
			<div style={{ height: '700%', overflow: 'hidden' }}>{text.current}</div>
			<animated.svg
				viewBox="0 0 490 512"
				style={{
					transform: xy.interpolate(svgTrans),
				}}
			>
				<Bg />
				{/*<Sweater />*/}
				{/*<Face />*/}
			</animated.svg>
		</div>
	);
};

export default ScrollParallax;
